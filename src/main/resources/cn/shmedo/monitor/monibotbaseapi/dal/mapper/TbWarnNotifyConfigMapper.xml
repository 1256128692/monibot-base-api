<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.shmedo.monitor.monibotbaseapi.dal.mapper.TbWarnNotifyConfigMapper">

    <select id="queryByProjectIDAndPlatform" resultType="cn.shmedo.monitor.monibotbaseapi.model.db.TbWarnNotifyConfig">
        SELECT twnc.`CompanyID`,
               twnc.`Platform`,
               twnc.`NotifyType`,
               twnc.`WarnLevel`,
               twnc.`NotifyMethod`,
               twnc.`Depts`,
               twnc.`Users`,
               twnc.`Roles`,
               twnc.`ExValue`,
               tncpr.ProjectID projectID
        FROM `tb_warn_notify_config` twnc
                 LEFT JOIN `tb_notify_config_project_relation` tncpr ON twnc.ID = tncpr.NotifyConfigID
        <where>
            <trim prefixOverrides="AND">
                <if test="projectID != null">
                    AND tncpr.ProjectID = #{projectID}
                </if>
                <if test="notifyType != null">
                    AND twnc.`NotifyType` = #{notifyType}
                </if>
                <if test="platform != null">
                    AND twnc.`Platform` = #{platform}
                </if>
            </trim>
        </where>
    </select>
</mapper>